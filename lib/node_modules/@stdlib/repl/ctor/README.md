<!--

@license Apache-2.0

Copyright (c) 2019 The Stdlib Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

-->

# REPL

> Read-Eval-Print Loop (REPL) environment.

<!-- Section to include introductory text. Make sure to keep an empty line after the intro `section` element and another before the `/section` close. -->

<section class="intro">

A Read-Eval-Print Loop (REPL) environment is an interactive programming environment which takes individual user inputs (e.g., single expressions), evaluates those inputs, and returns the result. Accordingly, a program written in a REPL environment is executed piecewise and sequentially.

REPL environments find common use in exploratory programming, prototyping, and debugging.

The REPL environment exposed here is available both as a standalone application and as a library which is embeddable in other libraries and applications.

</section>

<!-- /.intro -->

<!-- Package usage documentation. -->

<section class="usage">

## Usage

```javascript
var REPL = require( '@stdlib/repl/ctor' );
```

#### REPL( \[options] )

Returns a `REPL` instance.

```javascript
// Create a new REPL:
var repl = new REPL();

// ...

// Close the REPL:
repl.close();
```

The function accepts the following `options`:

-   **input**: input (readable) stream. Default: [`stdin`][@stdlib/streams/node/stdin].
-   **output**: output (writable) stream. Default: [`stdout`][@stdlib/streams/node/stdout].
-   **sandbox**: `boolean` indicating whether to run a REPL in a sandboxed context. Default: `false`.
-   **timeout**: number of milliseconds to execute a command before terminating execution. Default: `4294967295`.
-   **isTTY**: `boolean` indicating whether the input and output streams should be treated like a TTY (terminal) and whether the REPL should use ANSI/VT100 escape codes when writing to the output stream.
-   **inputPrompt**: input prompt. If the input prompt includes the character sequence `%d`, the input prompt includes line numbers. Default: `'In [%d]: '`.
-   **outputPrompt**: output prompt. If the output prompt includes the character sequence `%d`, the output prompt includes line numbers. Default: `'Out[%d]: '`.
-   **welcome**: welcome message.
-   **padding**: number of empty lines between consecutive commands. Default: `1`.
-   **load**: file path specifying a JavaScript file to load and evaluate line-by-line (e.g., a previous REPL history file).
-   **save**: file path specifying where to save REPL command history.
-   **log**: file path specifying where to save REPL commands and printed output.

#### REPL.prototype.createContext()

Returns a REPL context.

```javascript
// TODO
```

#### REPL.prototype.resetContext()

Resets a REPL's execution context.

```javascript
// TODO
```

#### REPL.prototype.load( fpath )

Loads and evaluates a JavaScript file line-by-line.

```javascript
// TODO
```

#### REPL.prototype.reset()

Resets a REPL.

```javascript
// TODO
```

#### REPL.prototype.clear()

Clears the entire REPL screen and scrollback history.

```javascript
// TODO
```

This method is **only** applicable for TTY REPLs. In non-TTY REPLs, this method is a non-operation.

#### REPL.prototype.close()

Closes a REPL.

```javascript
// TODO
```

* * *

### Commands

REPL instances support the following commands...

#### alias2pkg( arg )

Returns the package name associated with a provided alias or class instance.

```javascript
// TODO
```

**Note**: only direct instances of documented built-in constructors are supported.

#### alias2related( arg )

Returns aliases related to a specified alias or class instance.

```javascript
// TODO
```

**Note**: only direct instances of documented built-in constructors are supported.

#### ans

Result of the last successfully executed command.

```javascript
// TODO
```

#### assignfrom( workspace, variable )

Reads a value from a specified `workspace`.

```javascript
// TODO
```

#### assignin( workspace, variable, value )

Assigns a `value` to a `variable` in a specified `workspace`.

```javascript
// TODO
```

#### clear()

Clears the entire REPL screen and scrollback history.

```javascript
// TODO
```

**Note**: this function is only applicable for TTY REPLs. In non-TTY REPLs, this function is a non-operation.

#### clearvars( \[options] )

Deletes user-defined variables in the current workspace.

```javascript
// TODO
```

The function supports the following `options`:

-   **include**: regular expression variable name inclusion filter.
-   **exclude**: regular expression variable name exclusion filter.

#### clearWorkspace( \[name, ]\[options] )

Deletes user-defined variables in a specified workspace.

```javascript
// TODO
```

By default, the function clears user-defined variables in the current workspace. To clear user-defined variables in a different workspace, provide a workspace `name`.

```javascript
// TODO
```

The function supports the following `options`:

-   **include**: variable name inclusion filter. May be either an array-like `object` or a regular expression.
-   **exclude**: variable name exclusion filter. May be either an array-like `object` or a regular expression.

```javascript
// TODO
```

#### currentWorkspace

Returns the name of the current workspace.

```javascript
// TODO
```

#### deleteWorkspace( \[name] )

Deletes a workspace.

```javascript
// TODO
```

If not provided an argument, the REPL deletes the current workspace and switches to the `'base'` workspace.

```javascript
// TODO
```

**Note**: the `'base'` workspace **cannot** be deleted.

#### evalin( workspace, expression )

Evaluates an `expression` in a specified `workspace`.

```javascript
// TODO
```

#### example( arg )

Runs examples for a specified alias, property, or class instance.

```javascript
// TODO
```

**Note**: only direct instances of documented built-in constructors are supported.

#### help( \[arg] )

Prints help text.

```javascript
// TODO
```

To print help text for an alias,

```javascript
// TODO
```

To print help text for a property,

```javascript
// TODO
```

To print help text for a class instance,

```javascript
// TODO
```

**Note**: only direct instances of documented built-in constructors are supported.

#### info( arg )

Prints abbreviated help text for a provided alias, property, or class instance.

```javascript
// TODO
```

**Note**: only direct instances of documented built-in constructors are supported.

#### isKeyword( keyword )

Returns a `boolean` indicating whether a string is a reserved keyword in the REPL environment.

```javascript
// TODO
```

#### load( fpath )

Loads and evaluates a JavaScript file, such as a REPL history file, line-by-line.

```javascript
// TODO
```

#### loadWorkspace( name\[, options] )

Loads variables from a specified workspace into the current workspace.

```javascript
// TODO
```

The function supports the following `options`:

-   **include: variable name inclusion filter. May be either an array-like `object` or a regular expression.
-   **exclude: variable name exclusion filter. May be either an array-like `object` or a regular expression.
-   **override**: `boolean` indicating whether to override existing workspace variables. Default: `true`.

```javascript
// TODO
```

#### logStart( fpath )

Starts logging commands and printed output to a specified file path.

```javascript
// TODO
```

#### logStop( id )

Stops logging commands and printed output to a file path associated with a specified record identifier.

```javascript
// TODO
```

#### quit()

Exits the REPL.

```javascript
// TODO
```

#### reset()

Resets the REPL.

```javascript
// TODO
```

#### save( fpath )

Saves previous commands to a specified file path.

```javascript
// TODO
```

#### saveStart( fpath )

Starts saving commands to a specified file path.

```javascript
// TODO
```

#### saveStop( id )

Stops saving commands to a file path associated with a specified record identifier.

```javascript
// TODO
```

#### vars( \[options] )

Returns a list of variable names in the current workspace.

```javascript
// TODO
```

The function supports the following `options`:

-   **include**: regular expression variable name inclusion filter.
-   **exclude**: regular expression variable name exclusion filter.
-   **types**: array-like `object` containing variable type inclusion filter(s).
-   **details**: `boolean` indicating whether to include additional variable details, such as variable type, contents, etc. Default: `false`.

```javascript
// TODO
```

#### varsWorkspace( \[name, ]\[options] )

Returns a list of variable names in a specified workspace.

```javascript
// TODO
```

The function supports the following `options`:

-   **include**: regular expression variable name inclusion filter.
-   **exclude**: regular expression variable name exclusion filter.
-   **types**: array-like `object` containing variable type inclusion filter(s).
-   **details**: `boolean` indicating whether to include additional variable details, such as variable type, contents, etc. Default: `false`.

```javascript
// TODO
```

#### workspace( name )

Switch to a specified workspace.

```javascript
// TODO
```

If a workspace with the specified `name` does not exist, the workspace is created.

```javascript
// TODO
```

#### workspaces( \[options] )

Returns a list of workspace names.

```javascript
// TODO
```

The function supports the following `options`:

-   **include**: regular expression workspace name inclusion filter.
-   **exclude**: regular expression workspace name exclusion filter.
-   **details**: `boolean` indicating whether to include additional workspace details, such as variable names, types, contents, etc. Default: `false`.

```javascript
// TODO
```

</section>

<!-- /.usage -->

<!-- Package usage notes. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="notes">

</section>

<!-- /.notes -->

<!-- Package usage examples. -->

* * *

<section class="examples">

## Examples

<!-- eslint no-undef: "error" -->

```javascript
var join = require( 'path' ).join;
var REPL = require( '@stdlib/repl/ctor' );

function onExit() {
    console.log( '' );
    console.log( 'REPL closed.' );
}

// Create a new REPL:
var repl = new REPL();
repl.on( 'exit', onExit );

// Load a history file:
repl.load( join( __dirname, 'examples', 'history.txt' ) );

// Close the REPL:
repl.close();
```

</section>

<!-- /.examples -->

<!-- Section for describing a command-line interface. -->

* * *

<section class="cli">

## CLI

<!-- CLI usage documentation. -->

<section class="usage">

### Usage

```text
Usage: stdlib-repl [options]

Options:

  -h, --help                    Print this message.
  -V, --version                 Print the package version.
      --welcome <message>       Welcome message.
      --input_prompt <prompt>   Input prompt. Default: 'In [%d]: '.
      --output_prompt <prompt>  Output prompt. Default: 'Out[%d]: '.
      --padding <padding>       Empty lines between commands. Default: 1.
      --load <filepath>         JavaScript file to evaluate line-by-line.
      --save <filepath>         File to save REPL command history.
      --logfile <filepath>      File to log REPL commands and printed output.
      --timeout <timeout>       Milliseconds before terminating a command.
```

</section>

<!-- /.usage -->

<!-- CLI usage notes. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="notes">

</section>

<!-- /.notes -->

<!-- CLI usage examples. -->

<section class="examples">

### Examples

```bash
$ stdlib-repl
```

</section>

<!-- /.examples -->

</section>

<!-- /.cli -->

<!-- Section to include cited references. If references are included, add a horizontal rule *before* the section. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="references">

</section>

<!-- /.references -->

<!-- Section for all links. Make sure to keep an empty line after the `section` element and another before the `/section` close. -->

<section class="links">

[@stdlib/streams/node/stdin]: https://github.com/stdlib-js/stdlib

[@stdlib/streams/node/stdout]: https://github.com/stdlib-js/stdlib

</section>

<!-- /.links -->
