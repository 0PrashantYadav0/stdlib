'use strict';

// MODULES //

var nextTick = require( './../utils/next_tick.js' );


// MAIN //

/**
* Ends a benchmark.
*
* @private
*/
function end() {
	/* eslint-disable no-invalid-this */
	/* jshint validthis: true */ // TODO: remove
	var self = this;
	if ( this._ended ) {
		this.fail( '.end() called more than once' );
	} else {
		nextTick( onTick );
	}
	this._ended = true;

	/**
	* Callback invoked upon the next tick of the event loop.
	*
	* @private
	*/
	function onTick() {
		self.emit( 'end' );
	} // end FUNCTION onTick()
} // end FUNCTION end()


// EXPORTS //

module.exports = end;
