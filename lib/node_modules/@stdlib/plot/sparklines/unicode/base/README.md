<!--

@license Apache-2.0

Copyright (c) 2018 The Stdlib Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

-->

# Sparkline

> Base class for Unicode sparklines.

<section class="usage">

## Usage

```javascript
var Sparkline = require( '@stdlib/plot/sparklines/unicode/base' );
```

#### Sparkline( \[data,] \[options] )

Returns a `sparkline` instance.

```javascript
var sparkline = new Sparkline();
// returns <Sparkline>
```

The constructor accepts the following `options`:

-   **autoRender**: `boolean` indicating whether to re-render on a `change` event.
-   **bufferSize**: data buffer size. If provided,  data is kept in a first-in first-out (FIFO) buffer which cannot exceed the buffer size. Default: `+infinity`.
-   **data**: sparkline data.
-   **isDefined**: accessor `function` indicating whether a datum is defined.
-   **labels**: data labels.
-   **yMax**: maximum value of the y-axis domain.
-   **yMin**: minimum value of the y-axis domain.

* * *

### Writable Properties

<a name="prop-auto-render"></a>

#### Sparkline.prototype.autoRender

Rendering mode. If `true`, an instance renders on each `'change'` event; otherwise, rendering must be triggered manually.

```javascript
var sparkline = new Sparkline();

// Set:
sparkline.autoRender = false;

// Get:
var mode = sparkline.autoRender;
// returns false
```

<a name="prop-buffer-size"></a>

#### Sparkline.prototype.bufferSize

Data buffer size. If set, this specifies the maximum number of data elements which can be rendered. Once the data buffer is full, each new datum results in the oldest datum being removed.

```javascript
var sparkline = new Sparkline();

// Set:
sparkline.bufferSize = 3;

// Get:
var size = sparkline.bufferSize;
// returns 3

sparkline.data = [ 1, 2, 3 ];

var data = sparkline.data;
// returns [ 1, 2, 3 ]

sparkline.push( 4 );

data = sparkline.data;
// returns [ 2, 3, 4 ]
```

Setting a data buffer size is useful when rendering data streams.

<a name="prop-data"></a>

#### Sparkline.prototype.data

Sparkline data. When set, the value must be either `array`-like or an [ndarray][@stdlib/ndarray/ctor] and cannot exceed the `bufferSize`.

```javascript
var Float32Array = require( '@stdlib/array/float32' );

var sparkline = new Sparkline();

// Set:
sparkline.data = new Float32Array( [ 3.14, 5.0, -3.14, -1.0 ] );

// Get:
var data = sparkline.data;
// returns [ 3.14, 5.0, -3.14, -1.0 ]
```

Note that data is **copied** to an internal data buffer.

<a name="prop-is-defined"></a>

#### Sparkline.prototype.isDefined

An accessor `function` which defines whether a datum is defined. This accessor is used to define how missing values are encoded. The default behavior is to ignore values which are `NaN`.

```javascript
function isDefined( d ) {
    return ( d !== null );
}

var sparkline = new Sparkline();

// Set:
sparkline.isDefined = isDefined;

// Get:
var fcn = sparkline.isDefined;
// returns <Function>
```

<a name="prop-labels"></a>

#### Sparkline.prototype.labels

Data labels. During sparkline creation, each dataset is assigned a `label`. If the number of `labels` is less than the number of datasets, `labels` are reused using modulo arithmetic.

```javascript
var sparkline = new Sparkline();

// Set:
sparkline.labels = [
    'beep', // assigned to datasets 0,2,4,...
    'boop'  // assigned to datasets 1,3,5,...
];

// Get:
var labels = sparkline.labels;
// returns ['beep','boop']
```

<a name="prop-y-min"></a>

#### Sparkline.prototype.yMin

Minimum value of the `y`-axis domain. For certain sparkline implementations, setting this value will fix the minimum value.

```javascript
var sparkline = new Sparkline();

// Set:
sparkline.yMin = -100.0;

// Get:
var yMin = sparkline.yMin;
// returns -100.0
```

<a name="prop-y-max"></a>

#### Sparkline.prototype.yMax

Maximum value of the y-axis domain. For certain sparkline implementations, setting this value will fix the maximum value.

```javascript
var sparkline = new Sparkline();

// Set:
sparkline.yMax = 100.0;

// Get:
var yMax = sparkline.yMax;
```

* * *

### Methods

<a name="method-push"></a>

#### Sparkline.prototype.push( datum )

Append data to a sparkline.

```javascript
var sparkline = new Sparkline();

// Set:
sparkline.data = [ 1, 2, 3 ];

// Get:
var data = sparkline.data;
// returns [ 1, 2, 3 ]

sparkline.push( 4 );

data = sparkline.data;
// returns [ 1, 2, 3, 4 ]
```

<a name="method-render-private"></a>

#### Sparkline.prototype._render()

Private method for rendering a sparkline. Calls `_render()`.

<a name="method-render"></a>

#### Sparkline.prototype.render()

Public method for rendering a sparkline. This method **should be** implemented by `Sparkline` descendants.

<a name="method-tostring"></a>

#### Sparkline.prototype.toString()

Serializes a sparkline as a `string` by calling the `render()` method.

```javascript
var sparkline = new Sparkline();

var str = sparkline.toString();
// returns '...'
```

</section>

<!-- /.usage -->

<section class="examples">

* * *

## Examples

<!-- eslint-disable no-restricted-syntax, no-underscore-dangle -->

<!-- eslint no-undef: "error" -->

```javascript
var inherit = require( '@stdlib/utils/inherit' );
var Sparkline = require( '@stdlib/plot/sparklines/unicode/base' );

// Define a chart constructor:
function Chart( opts ) {
    if ( opts === void 0 ) {
        opts = {};
    }
    // Call the parent constructor:
    Sparkline.call( this, opts );

    return this;
}

// Inherit from the Sparkline constructor:
inherit( Chart, Sparkline );

// Implement a custom render method:
Chart.prototype._render = function render() {
    var str;
    var i;

    str = '';
    for ( i = 0; i < this._data.length; i++ ) {
        if ( this._data[ i ] > 0 ) {
            str += '↑';
        } else {
            str += '↓';
        }
    }
    return str;
};

// Create a new chart instance:
var chart = new Chart();

// Set chart data:
chart.data = [ 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0 ];

// Render the chart:
console.log( chart.render() );
// => '↑↓↓↑↓↑↑↑↓↑↑↓↓'
```

</section>

<!-- /.examples -->

<section class="links">

[@stdlib/ndarray/ctor]: https://github.com/stdlib-js/stdlib

</section>

<!-- /.links -->
