'use strict';

// MODULES //

var debug = require( 'debug' )( 'plot:view:electron:main-process' );
var app = require( 'electron' ).app;
var BrowserWindow = require( 'electron' ).BrowserWindow;


// VARIABLES //

var mainWindow = null;
var width = process.env.WIDTH;
var height = process.env.HEIGHT;
var address = process.env.ADDRESS;
var port = process.env.PORT;
var url = 'http://'+address+':'+port+'/index.html';


// FUNCTIONS //

/**
* Creates a browser window.
*
* @private
*/
function createWindow() {
	debug( 'Creating a new %d x %d browser window...', width, height );
	mainWindow = new BrowserWindow({
		'width': width,
		'height': height
	});

	debug( 'Loading %s.', url );
	mainWindow.loadURL( url );

	mainWindow.on( 'close', onClose );
} // end FUNCTION createWindow()

/**
* Callback invoked once a window closes.
*
* @private
*/
function onClose() {
	debug( 'Window closed. Dereferencing window object to allow for GC...' );
	mainWindow = null;
} // end FUNCTION onClose()

/**
* Quits the application.
*
* @private
*/
function quit() {
	debug( 'Quitting application...' );
	app.quit();
} // end FUNCTION quit()


// MAIN //

/**
* Runs the application.
*
* @private
*/
function main() {
	app.on( 'ready', createWindow );
	app.on( 'window-all-closed', quit );
} // end FUNCTION main()

debug( 'Running application...' );
main();
