'use strict';

// MODULES //

var debug = require( 'debug' )( 'plot:render:svg:marks' );
var Path = require( '@stdlib/plot/components/svg/path' );


// RENDER //

/**
* Renders individual marks.
*
* @private
* @param {Object} state - state
* @returns {VTree} virtual tree
*/
function render( state ) {
	var lineStyles;
	var lineStyle;
	var numStyles;
	var numColors;
	var isDefined;
	var xScale;
	var yScale;
	var parent;
	var labels;
	var colors;
	var mark;
	var len;
	var x;
	var y;
	var i;
	var j;

	debug( 'Rendering marks group...' );
	parent = state.$.svg.marks.render();

	x = state.x;
	len = x.length;
	if ( len === 0 ) {
		debug( 'No individual marks to render.' );
		return parent;
	}
	y = state.y;
	xScale = state.xScale;
	yScale = state.yScale;
	isDefined = state.isDefined;
	labels = state.labels;
	colors = state.colors;
	lineStyles = [ '-' ]; //state.lineStyles; FIXME

	numStyles = lineStyles.length;
	numColors = colors.length;

	debug( 'Rendering individual marks...' );
	for ( i = 0; i < len; i++ ) {
		j = i + 1;
		debug( 'Rendering mark %d of %d...', j, len );

		lineStyle = lineStyles[ i%numStyles ];
		debug( 'Line style: %s (%d).', lineStyle, j );

		if ( lineStyle === '-' ) {
			debug( 'Rendering a line (%d)...', j );
			mark = new Path({
				'x': x[ i ],
				'y': y[ i ],
				'xScale': xScale,
				'yScale': yScale,
				'isDefined': isDefined,
				'label': labels[ i ] || '',
				'color': colors[ i%numColors ] || '',
				'autoRender': false
			});
			mark = mark.render();
		}
		debug( 'Finished rendering mark %d of %d.', j, len );

		debug( 'Inserting mark (%d) into marks group...', j );
		parent.children.push( mark );
		parent.count += mark.count;
	}
	debug( 'Finished rendering marks.' );
	return parent;
} // end FUNCTION render()


// EXPORTS //

module.exports = render;
