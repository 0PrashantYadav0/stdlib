'use strict';

// MODULES //

var ln = require( '@stdlib/math/base/special/ln' );


// NORMAL TAIL //

/**
* Transform the tail of the normal distribution to the unit interval and then use rejection technique to generate standard normal variable.
*
* #### References
*
* * Marsaglia, G. (1964). Generating a Variable from the Tail of the Normal Distribution. Technometrics, 6(1), 101â€“102. doi:10.1080/00401706.1964.10490150
*
* @private
* @param {number} dMin - start value of the right tail
* @param {boolean} iNegative - boolean indicating which side to evaluate
* @param {Function} rand - random number generator
* @returns {number} standard normal variable
*/
function dRanNormalTail( dMin, iNegative, rand ) {
	var x;
	var y;
	do {
		x = ln( rand() ) / dMin;
		y = ln( rand() );
	} while ( -2 * y < x * x );
	return iNegative ? x - dMin : dMin - x;
} // end FUNCTION dRanNormalTail()


// EXPORTS //

module.exports = dRanNormalTail;
