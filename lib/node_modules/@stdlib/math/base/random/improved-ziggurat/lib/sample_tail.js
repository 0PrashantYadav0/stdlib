'use strict';

// MODULES //

var ln = require( '@stdlib/math/base/special/ln' );


// MAIN //

/**
* Transforms the tail of the normal distribution to the unit interval and then uses rejection technique to generate standard normal variable.
*
* #### References
*
* * Marsaglia, George. 1964. "Generating a Variable from the Tail of the Normal Distribution." *Technometrics* 6 (1): 101â€“2. doi:[10.1080/00401706.1964.10490150](http://dx.doi.org/10.1080/00401706.1964.10490150).
*
* @private
* @param {Function} rand - random number generator
* @param {number} rTail - start value of the right tail
* @param {boolean} isNegative - boolean indicating which side to evaluate
* @returns {number} standard normal variable
*/
function sampleTail( rand, rTail, isNegative ) {
	var x;
	var y;
	do {
		x = ln( rand() ) / rTail;
		y = ln( rand() );
	} while ( -2.0*y < x*x );
	return isNegative ? x - rTail : rTail - x;
} // end FUNCTION sampleTail()


// EXPORTS //

module.exports = sampleTail;
