'use strict';

// MAIN //

/**
* Returns a pseudorandom number drawn from a hypergeometric distribution.
*
* #### References
*
* * Kachitvichyanukul, Voratas., and Burce Schmeiser. 1985. "Computer generation of hypergeometric random variates." *Journal of Statistical Computation and Simulation* 22 (2): 127â€“45. doi:[10.1080/00949658508810839][@kachitvichyanukul:1985].
*
* [@kachitvichyanukul:1985]: http://dx.doi.org/10.1080/00949658508810839
*
*
* @private
* @param {Function} rand - PRNG for uniformly distributed number
* @param {NonNegativeInteger} N - population size
* @param {NonNegativeInteger} K - subpopulation size
* @param {NonNegativeInteger} n - number of draws
* @returns {NonNegativeInteger} pseudorandom number
*/
function hypergeometric( rand, N, K, n ) {
	var i;
	var k;
	var m;
	var u;
	var x;

	x = 0;
	m = N;
	k = K;
	for ( i = 0; i <= n; i++ ) {
		u = rand();
		if ( u < k/m ) {
			x += 1;
			if ( x === K ) {
				return x;
			}
			k -= 1;
		}
		m -= 1;
	}
	return x;
} // end FUNCTION hypergeometric()


// EXPORTS //

module.exports = hypergeometric;
