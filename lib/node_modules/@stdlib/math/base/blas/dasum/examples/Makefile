
# VARIABLES #

# Define the program used for compiled C source files:
CC ?= gcc

# Define the command-line options when compiling C files (`-O3` for aggressive optimization):
CFLAGS ?= -O3

# Define the program for linking compiled files:
LINKER ?= gfortran

# Define the command-line options when linking compiled files:
LINKER_FLAGS ?=

# List of Fortran objects:
fortran_objects := ./../src/dasum.o ./../src/dasum_wrapper.o

# List of C objects:
c_objects := ./../src/c_dasum.o

# List of example targets:
example_objects := example.o

# Filename of executable:
executable := ./example.out


# TARGETS #

# Default target.
#
# This target is the default target.

all: examples

.PHONY: all


# Compile C source.
#
# This target compiles C source files.

$(example_objects): %.o: %.c
	$(CC) $(CFLAGS) -I ../include -c -o $@ $<


# Generate executables.
#
# This target generates example executables.

examples: $(example_objects)
	$(LINKER) $(LINKER_FLAGS) -o $(executable) $(example_objects) $(c_objects) $(fortran_objects)

.PHONY: examples


# Run example.
#
# This target runs an example.

run: $(executable)
	$(executable)

.PHONY: run


# Perform clean-up.
#
# This target removes generated files.

clean:
	$(QUIET) rm -f *.o $(executable)

.PHONY: clean
