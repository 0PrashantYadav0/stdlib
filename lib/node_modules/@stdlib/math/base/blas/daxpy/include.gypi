# A GYP include file for building a Node.js native add-on.
#
# Note that nesting variables is required due to how GYP processes a configuration. Any variables defined within a nested 'variables' section is defined in the outer scope. Thus, conditions in the outer variable scope are free to use these variables without running into "variable undefined" errors.
#
# Main documentation:
# [1]: https://gyp.gsrc.io/docs/InputFormatReference.md
# [2]: https://gyp.gsrc.io/docs/UserDocumentation.md
#
# Variable nesting hacks:
# [3]: https://chromium.googlesource.com/external/skia/gyp/+/master/common_variables.gypi
# [4]: https://src.chromium.org/viewvc/chrome/trunk/src/build/common.gypi?revision=127004
{
  # Define variables to be used throughout the configuration for all targets:
  'variables': {
    'variables': {
      # Host BLAS library (to override -Dblas=<blas>):
      'blas%': '',
    },

    # Source directory:
    'src_dir': './src',

    # Include directories:
    'include_dirs': [
      '<!@(node -e "var arr = require(\'@stdlib/tools/library-manifest\')({\'os\':\'<(OS)\',\'blas\':\'<(blas)\'},{\'basedir\':process.cwd()}).include; for ( var i = 0; i < arr.length; i++ ) { console.log( arr[ i ] ); }")',
    ],

    # Add-on destination directory:
    'addon_output_dir': './src',

    # Source files:
    'src_files': [
      '<(src_dir)/addon.cpp',
      '<!@(node -e "var arr = require(\'@stdlib/tools/library-manifest\')({\'os\':\'<(OS)\',\'blas\':\'<(blas)\'},{\'basedir\':process.cwd()}).src; for ( var i = 0; i < arr.length; i++ ) { console.log( arr[ i ] ); }")',
    ],

    # Library dependencies:
    'libraries': [
      '<!@(node -e "var arr = require(\'@stdlib/tools/library-manifest\')({\'os\':\'<(OS)\',\'blas\':\'<(blas)\'},{\'basedir\':process.cwd()}).libraries; for ( var i = 0; i < arr.length; i++ ) { console.log( arr[ i ] ); }")',
    ],

    # Library directories:
    'library_dirs': [
      '<!@(node -e "var arr = require(\'@stdlib/tools/library-manifest\')({\'os\':\'<(OS)\',\'blas\':\'<(blas)\'},{\'basedir\':process.cwd()}).libpath; for ( var i = 0; i < arr.length; i++ ) { console.log( arr[ i ] ); }")',
    ],
  }, # end variables
}
