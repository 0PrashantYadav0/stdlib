# Chi-square goodness-of-fit test

> Perform a chi-square goodness-of-fit test.


<!-- <usage> -->

## Usage

``` javascript
var chi2gof = require( '@stdlib/math/generics/statistics/chi2gof' );
```

### chi2gof( x, p[, opts] )

For an [array][array] or [typed array][typed-array] of integers `x`, a chi-square goodness-of-fit is computed for the null hypothesis that the values of `x` come from a distribution with population probabilities equal to those in `p`. The function returns an object holding the calculated test statistic, the p-value of the test as well as the test decision.

``` javascript
var out;
var x;
var p;

x = [ 89, 37, 30, 28, 2 ];
p = [ 0.40, 0.20, 0.20, 0.15, 0.05 ];

out = chi2gof( x, p );
/* returns
    {
        rejected: true,
        alpha: 0.05,
        pValue: 0.018650106520189613,
        df: 3,
        statistic: 9.990143369175627,
        ...
    }
*/
```

The returned object comes with a `.print()` method which when invoked will print a formatted output of the results of the hypothesis test.

```javascript
console.log( out.print() );
/* =>
    Chi-square goodness-of-fit test

    Null hypothesis: population probabilities are equal to those in p

        pValue: 0.0406
        statistic: 9.9901
        degrees of freedom: 4

    Test Decision: Reject null in favor of alternative at 5% significance level
*/
```

The function accepts the following `options`:

* __alpha__: `number` in the interval `[0,1]` giving the significance level of the hypothesis test. Default: `0.05`.
* __rescale__: `boolean` indicating if p should be rescaled to sum to 1. Default: `false`.
* __ddof__: "delta degrees of freedom" adjustment. Has to be a nonnegative integer. Default: `0`.

By default, the test is carried out at a significance level of `0.05`. To choose a custom significance level, set the `alpha` option.

``` javascript
var table = out.print();
/*
    Chi-square goodness-of-fit test

    Null hypothesis: population probabilities are equal to those in p

        pValue: 0.0406
        statistic: 9.9901
        degrees of freedom: 4

    Test Decision: Reject null in favor of alternative at 5% significance level
*/

out = chi2gof( x, p, {
    'alpha': 0.01
});
table = out.print();
/*
    Chi-square goodness-of-fit test

    Null hypothesis: population probabilities are equal to those in p

        pValue: 0.0406
        statistic: 9.9901
        degrees of freedom: 4

    Test Decision: Fail to reject null in favor of alternative at 1% significance level
*/
```

If the elements of `p` do not sum up to one, set the `rescale` option. 

``` javascript
var x = [ 89, 37, 30, 28, 2 ];
var p = [ 40, 20, 20, 15, 5 ];

var out = chi2gof( x, p, {
    'rescale': true
});
// returns { 'pValue': ~0.0406, 'statistic': ~9.9901, 'df': 4, ... }
```

By default, the p-value is computed using a chi-square distribution with `k - 1` degrees of freedom, where `k` is the number of levels of `x`. In case distribution parameters were estimated for the calculation of `p`, the degrees of freedom have to be corrected. Set the `ddof` option to use `n - ddof - 1` degrees of freedom.


``` javascript
var x = [ 89, 37, 30, 28, 2 ];
var p = [ 0.40, 0.20, 0.20, 0.15, 0.05 ];

var out = chi2gof( x, p, {
    'ddof': 1
});
// returns { 'pValue': ~0.0186, 'statistic': ~9.9901, 'df': 3, ... }
```


<!-- </usage> -->

<!-- <notes> -->

## Notes

* The chi-square approximation may be incorrect if the observed or expected frequencies in each category are too small. It is common to require frequencies greater than five.

<!-- </notes> -->

<!-- <examples> -->

## Examples

``` javascript
var poisson = require( '@stdlib/math/base/random/poisson' );
var pmf = require( '@stdlib/math/base/dist/poisson/pmf' );
var chi2gof = require( '@stdlib/math/generics/statistics/chi2gof' );

var table;
var rpois;
var probs;
var freqs;
var len;
var out;
var val;
var i;
var x;

// Draw 400 samples from a Poisson( 3.0 ) distribution:
rpois = poisson.factory( 3.0 );

len = 400;
x = new Array( len );
for ( i = 0; i < len; i++ ) {
    x[ i ] = rpois();
}

// Generate frequency table:
freqs = [];
for ( i = 0; i < len; i++ ) {
    val = x[ i ];
    if ( freqs[ val ] === void 0 ) {
        freqs[ val ] = 1;
    } else {
        freqs[ val ] += 1;
    }
}

// Fill holes in array:
for ( i = 0; i < freqs.length; i++ ) {
    if ( freqs[ i ] === void 0 ) {
        freqs[ i ] = 0;
    }
}

// Get Poisson probabilities:
probs = new Array( freqs.length );
for ( i = 0; i < freqs.length; i++ ) {
    probs[ i ] = pmf( i, 3.0 );
}

out = chi2gof( freqs, probs, {
    'rescale': true
});
table = out.print();
```

<!-- </examples> -->


<!-- <links> -->

[array]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array
[function]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function
[typed-array]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays
[string]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String

<!-- </links> -->
