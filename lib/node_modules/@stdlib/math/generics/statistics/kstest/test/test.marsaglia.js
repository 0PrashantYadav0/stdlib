'use strict';

// MODULES //

var tape = require( 'tape' );
var abs = require( '@stdlib/math/base/special/abs' );
var pKolmogorov = require( './../lib/marsaglia.js' );


// FUNCTIONS //

function almostEqual( a, b, tol ) {
	var delta = abs( a - b );
	tol = tol * abs( b );
	return ( delta <= tol );
}


// TESTS //

tape( 'main export is a function', function test( t ) {
	t.ok( true, __filename );
	t.equal( typeof pKolmogorov, 'function', 'main export is a function' );
	t.end();
});

tape( 'the function correctly evaluates the CDF of D_n', function test( t ) {
	var bool;

	bool = almostEqual( pKolmogorov( 0.3, 10.0 ), 0.7294644, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( -0.1, 10.0 ), 0.0, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 1.5, 10.0 ), 1.0, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.5, 20.0 ), 0.9999621, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.1, 10.0 ), 0.00036288, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.1, 20.0 ), 0.02374491, 1e-6 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.05, 300.0 ), 0.5725584, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.05, 80.0 ), 0.01757889, 1e-6 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.8, 1.0 ), 0.6, 1e-7 );
	t.ok( bool, 'returns correct value' );
	bool = almostEqual( pKolmogorov( 0.274, 10.0 ), 0.6284796, 1e-7 );
	t.ok( bool, 'returns correct value' );

	t.end();
});

tape( 'the function correctly evaluates the CDF of D_n when overflow occurs', function test( t ) {
	var bool;

	bool = almostEqual( pKolmogorov( 0.05, 1000 ), 0.9869879, 1e-7 );
	t.ok( bool, 'returns correct value' );

	t.end();
});
