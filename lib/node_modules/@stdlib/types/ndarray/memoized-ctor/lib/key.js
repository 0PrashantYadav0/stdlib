'use strict';

// MODULES //

var options = require( './options.json' );


// VARIABLES //

var nopts = options.length;
var N = nopts - 1;


// MAIN //

/**
* Returns a cache key.
*
* @private
* @param {string} dtype - data type
* @param {Options} opts - function options
* @param {boolean} opts.codegen - boolean indicating whether to use code generation
* @param {string} opts.mode - specifies how to handle indices which exceed array dimensions
* @param {StringArray} opts.submode - specifies how to handle subscripts which exceed array dimensions on a per dimension basis
* @returns {string} cache key
*
* @example
* var opts = {
*     'codegen': true,
*     'mode': 'throw',
*     'submode': [ 'throw' ]
* };
* var key = getKey( 'float64', opts );
* // returns 'float64;codegen=true,mode="throw",submode=["throw"]'
*/
function getKey( dtype, opts ) {
	var key;
	var i;

	key = dtype + ';';
	for ( i = 0; i < nopts; i++ ) {
		// Note: we assume that an option value can be uniquely serialized to a `string` via `JSON.stringify()`...
		key += options[ i ] + '=' + JSON.stringify( opts[ options[i] ] );
		if ( i < N ) {
			key += ',';
		}
	}
	return key;
} // end FUNCTION getKey()


// EXPORTS //

module.exports = getKey;
