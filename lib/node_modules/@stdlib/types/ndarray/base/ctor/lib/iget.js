'use strict';

// MAIN //

/**
* Returns an array element located a specified linear view index.
*
* @private
* @param {integer} idx - linear view index
* @returns {*} array element
*/
function get( idx ) {
	/* eslint-disable no-invalid-this */
	var strides;
	var shape;
	var ndims;
	var ind;
	var s;
	var i;

	// Trivial case where we have all positive strides...
	if ( this._iterationOrder === 1 ) {
		return this._buffer[ this._offset + idx ];
	}
	// Trivial case where we have all negative strides...
	if ( this._iterationOrder === -1 ) {
		return this._buffer[ this._offset - idx ];
	}
	// The approach which follows is to resolve a view index to its subscripts and then plug the subscripts into the standard formula for computing the linear index in the underlying data buffer...
	shape = this._shape;
	ndims = this._shape.length;
	strides = this._strides;
	ind = this._offset;
	if ( this._order === 'column-major' ) {
		for ( i = 0; i < ndims; i++ ) {
			s = idx % shape[ i ];
			idx -= s;
			idx /= shape[ i ];
			ind += s * strides[ i ];
		}
		return this._buffer[ ind ];
	}
	// Case: row-major
	for ( i = ndims-1; i >= 0; i-- ) {
		s = idx % shape[ i ];
		idx -= s;
		idx /= shape[ i ];
		ind += s * strides[ i ];
	}
	return this._buffer[ ind ];
} // end FUNCTION get()


// EXPORTS //

module.exports = get;
