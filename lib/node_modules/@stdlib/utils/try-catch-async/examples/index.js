'use strict';

var randu = require( '@stdlib/math/base/random/randu' );
var trycatchAsync = require( './../lib' );

var i;

function next() {
	trycatchAsync( x, 'beep', done );
}

function x( clbk ) {
	setTimeout( onTimeout, 0 );
	function onTimeout() {
		if ( randu() > 0.9 ) {
			return clbk( null, 'BOOP' );
		}
		clbk( new Error( 'oops' ) );
	}
}

function done( error, result ) {
	if ( error ) {
		console.log( error.message );
	}
	i += 1;
	console.log( result );
	if ( i < 100 ) {
		next();
	}
}

i = 0;
next();
