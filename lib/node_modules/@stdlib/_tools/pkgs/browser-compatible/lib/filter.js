'use strict';

// MODULES //

var resolve = require( './resolve.js' );
var metafilter = require( './filter_meta.js' );


// MAIN //

/**
* Asynchronously filters a list of package names for packages which are compatible with browser environments.
*
* @private
* @param {StringArray} names - package names
* @param {string} dir - base directory from which to resolve packages
* @param {Callback} clbk - callback to invoke upon completion
*/
function filter( names, dir, clbk ) {
	resolve( names, dir, onResolve );

	/**
	* Callback invoked upon resolving package meta data.
	*
	* @private
	* @param {(Error|null)} error - error object
	* @param {ObjectArray} pkgs - package meta data
	* @returns {void}
	*/
	function onResolve( error, pkgs ) {
		if ( error ) {
			return clbk( error );
		}
		clbk( null, metafilter( pkgs ) );
	} // end FUNCTION onResolve()
} // end FUNCTION filter()


// EXPORTS //

module.exports = filter;
